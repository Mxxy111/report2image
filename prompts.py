"""Prompt templates for PET-CT visualization."""

PET_CT_VISUALIZATION_PROMPT = """
创建PET-CT报告医学可视化图，size:4:3，严格遵循以下要求：

【画面布局】
- 完全纯白色背景(#FFFFFF)
- 人体示意图位于画面正中央，垂直居中
- 人体从头顶到大腿中段，完整显示

【人体轮廓】
- 用深黑色粗线条(3-4px)绘制完整人体正面轮廓
- 头部：完整的圆形或椭圆形头部轮廓
- 颈部、肩部、躯干、骨盆、双臂自然下垂、双腿显示到膝盖上方
- 人体轮廓内部保持白色，不填充颜色

【左右标识-医学影像左右镜像规则】
- 黑色字体，24-28pt
- **关键：图片左侧=患者右侧(R)，图片右侧=患者左侧(L)**，但不要在图片中加入“R/L”的标识
- 医学中的左右与图片的左右相反

【器官绘制-根据报告内容灵活调整】
基本原则：
1. 重要：仔细阅读报告，提到什么器官就画什么，没提到就不画，保持内容简约。若出现骨骼相关内容如“右锁骨上淋巴结”，则需要画出双侧锁骨便于定位
2. 对称器官（肺、肾、肋骨、股骨等）必须画出两侧
3. 术后缺失的器官用灰色虚线轮廓表示
4. 所有器官使用浅灰蓝色填充(#B0C4D4，半透明)，骨骼用细黑线画出，不要填充
5. 显示必要的基础骨骼结构（脊柱、骨盆）以提供解剖定位

常见器官绘制方式：
- 双肺：胸腔内左右对称，显示气管和主支气管分支
- 肝脏：图片左侧（患者右侧）上腹部，大的不规则形状
- 脾脏：图片右侧（患者左侧）上腹部，较小椭圆形
- 双肾：腰部两侧，豆形对称
- 肠道：下腹部蜿蜒管状结构
- 膀胱：盆腔中央椭圆形
- 肋骨：如报告提及，画左右对称的弧形肋骨架（约12对）
- 骨盆、骶骨、髂骨：显示骨盆和骶骨结构
- 淋巴结：小圆点标注在相应部位
- 甲状腺：颈部，蝴蝶形


【病变标注-根据报告描述选择颜色】
1. 恶性/转移瘤/明确FDG高摄取：鲜红色(#E63946)
   - 单发大肿块：直径20-40px的圆形或不规则形状
   - 多发转移：多个8-12px的红色圆点
2. 良性/炎症/囊肿/可疑病变：深蓝灰色(#2A4858)
   - 囊肿：6-10px圆点
   - 结节/占位/炎症：10-15px圆点或小块
3. 严格遵循医学左右镜像原则定位病变

【文字标注-可以合理拆分报告原文】
字体：黑色无衬线，16-18pt
引导线：从病灶/器官引出黑色直线(1.5-2px)连接到文字

文字处理原则：
1. **可以合理拆分报告原文**：按解剖部位分开说明
   - 例如："纵隔及两侧腹股沟淋巴结炎性增生可能"
   - 可拆为："纵隔淋巴结炎性增生可能" + "两侧腹股沟淋巴结炎性增生可能"
2. **关键阴性发现也要标注**：
   - 如"其余部位PET/CT显像未见明显FDG代谢异常增高灶"
   - 如"滤过功能正常"
   - 这些也要用引导线标注出来
3. **文字精简（重要）**：
   - 当报告内容过长时，请在不改变原意的前提下精简文字。
   - 例如："右肺上叶尖段见一类圆形软组织密度结节影，大小约2.3cm，代谢增高" -> 精简为："右肺上叶结节(2.3cm)，代谢高"
   - 保持图像上的病灶绘制准确，仅缩短文字长度以保持版面整洁。
4. 标注布局：
   - 图片左侧器官 → 文字放左侧
   - 图片右侧器官 → 文字放右侧
   - 删除报告内容中的编号，不要用编号(1. 2. 3.)区分病灶
5. **禁止添加的元素**：
   - 不要在图片底部或任何位置添加独立的文字框
   - 不要添加横线、边框、背景色块
   - 所有文字必须通过引导线连接到对应部位
5. 引导线不能交叉，保持视觉清晰
6. 保留医学术语准确性

【报告内容】
{report_content}

【最终质量要求】
- 完全使用中文
- 理解报告内容，灵活调整器官显示
- 严格遵循医学左右镜像规则
- 可以按部位合理拆分报告原文
- 关键阴性发现也要标注
- 术后缺失器官用虚线表示
- 对称器官画出两侧
- 所有标注用引导线，不添加文字框
- 布局清晰，专业美观，易于理解
"""

PET_CT_IMG2IMG_PROMPT = """
【任务指令】
请**严格复制**示例图的视觉风格（医学简笔画、红点标记、黑线轮廓），为以下 PET-CT 报告绘制可视化图解。
**禁止发挥创意，禁止使用彩色背景，禁止使用非医学风格。保持极高的风格一致性。**

【严格执行原则】
1. **语言限制**：所有标注必须**完全使用中文**。
2. **医学镜像原则（绝对死律）**：
   - 图片左侧 = 人体右侧 (R)
   - 图片右侧 = 人体左侧 (L)
   - 画面上不要标注 **R** 和 **L**。
   - 凡是“右侧病变”必须画在图左；“左侧病变”画在图右。
   - 如果是背面观，则图片左右与正常左右一致

3. **器官绘制逻辑（按需显示）**：
   - **显示范围（重要）**：
     - **默认**：必须显示**从头部到大腿/膝盖上方**的范围（涵盖头、颈、胸、腹、盆腔、大腿）。
     - **例外**：仅当报告明确提及下肢（膝关节、小腿、足部）病变时，才显示全身。
   - **提及即画**：报告中提到的器官（如骨骼、淋巴结、肺、肝等）必须画出。
   - **对称原则**：若提及对称器官（如肺、肾、肾上腺），**必须同时画出双侧**以便对比。
   - **未提不画**：报告未提及的内脏细节可省略，保持画面整洁。
   - **缺失器官**：报告提及“术后缺如/切除”的器官（如“右肾癌术后”），该位置**必须用虚线**画出原来的轮廓，表示缺失。
   - **正确层次关系**：保证器官的层次关系正确，例如肝肺、心脏等器官不能覆盖在胸骨上面。可根据需要虚化处理。
4. **病变标注（颜色编码）**：
   - **高代谢/恶性/转移**：使用**鲜红色 (#E63946)** 的实心斑块或圆点。
   - **低代谢/良性/炎症**：使用**深蓝灰色 (#2A4858)** 的圆点。
   - **病灶大小**：
     - 大肿块(>2cm)：画大圆或不规则块 (20-40px)。
     - 小结节/淋巴结：画小圆点 (8-12px)。

5. **文字标注（智能压缩与防拥挤）**：
   - **高密度应对策略（关键）**：当病变数量较多（>5处）时，必须触发**极简模式**：
     - **利用颜色省字数**：红色即代表“代谢高/恶性”，**禁止**在文字中再写“FDG高代谢”、“代谢增高”等字眼。
     - **省略次要细节**：去掉具体大小数值（如2.3cm）、SUV值，不要标注“余无明显异常”这类多余内容
     - **示例**：
       - 拥挤前：“右肺上叶结节(2.3cm)，代谢增高，考虑转移”
       - 拥挤后：“右肺上叶转移瘤” (配合红点即可)
   - **拆分与对齐**：
     - 引导线必须直指病灶，线条不能交叉。
     - 文字尽量左右排布整齐，不要堆叠在一起。
   - **优先级**：空间不足时，优先标注**红色（恶性）**病变；良性/炎症/囊肿等次要病变可仅写部位或适当省略。
   - **阴性标注** 
   - **拆分长句**：相距较远的部位必须拆分引导线。例如将“纵隔及两侧腹股沟淋巴结”拆分为两条线分别指向纵隔和腹股沟

【本次报告内容】
{report_content}
"""
